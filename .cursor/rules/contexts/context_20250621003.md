---
description: 
globs: 
alwaysApply: false
---
# TASK CONTEXT: Phase 2 - Migrate Domain Layer

**Task ID**: `20250621003`
**Assignee**: `@coding_agent`
**Status**: `in_progress`
**Priority**: `high`

## 1. Objective

Migrate the Domain Layer from `cursor_agent/src/task_mcp/domain/` to `dhafnck_mcp_main/src/fastmcp/task_management/domain/`. This includes copying all domain files, updating Python import paths, and ensuring domain-level unit tests pass in the new location.

## 2. Technical Requirements

### Source Files to Migrate:
```
cursor_agent/src/task_mcp/domain/
├── entities/
├── repositories/
├── services/
├── value_objects/
└── exceptions/
```

### Target Location:
```
dhafnck_mcp_main/src/fastmcp/task_management/domain/
```

### Key Implementation Steps:
1. **Copy Domain Files**: Transfer all domain layer files maintaining directory structure
2. **Update Import Paths**: Modify all imports to reflect new `fastmcp.task_management.domain` namespace
3. **Validate Domain Logic**: Ensure all domain entities, value objects, and services function correctly
4. **Update Unit Tests**: Migrate and adapt domain-level unit tests
5. **Verify Dependencies**: Ensure no external dependencies are broken

## 3. Migration Specifics

### Import Path Changes:
- **From**: `from task_mcp.domain.entities import Task`
- **To**: `from fastmcp.task_management.domain.entities import Task`

### Domain Components to Migrate:
- **Entities**: Core business objects (Task, Subtask, Project, etc.)
- **Value Objects**: Immutable objects (TaskId, Priority, Status, etc.)
- **Domain Services**: Business logic services
- **Repositories**: Abstract repository interfaces
- **Exceptions**: Domain-specific exceptions

## 4. Success Criteria

- [ ] All domain files copied to new location
- [ ] Import paths updated throughout domain layer
- [ ] Domain unit tests pass in new environment
- [ ] No circular dependencies introduced
- [ ] Domain logic integrity maintained

## 5. Dependencies

**Requires**: Task 20250621002 (Scaffolding) - ✅ Complete
**Blocks**: Task 20250621004 (Application Layer Migration)
**References**: [`migration_plan.md`](mdc:../../migration_plan.md)
**Part of**: EPIC 20250621001 - Complete task_mcp module migration

## 6. Testing Strategy

### Domain Tests to Validate:
- Entity behavior and invariants
- Value object immutability
- Domain service business logic
- Repository interface contracts
- Exception handling scenarios

### Validation Checklist:
- [ ] All domain tests pass
- [ ] No import errors
- [ ] Business rules preserved
- [ ] Domain boundaries maintained

## 7. Notes

The domain layer is the core of the application and must be migrated with extreme care to preserve business logic integrity. All domain rules, constraints, and behaviors must remain unchanged during migration.

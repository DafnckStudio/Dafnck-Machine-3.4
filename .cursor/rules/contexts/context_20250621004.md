---
description:
globs:
alwaysApply: false
---
# TASK CONTEXT: Phase 3 - Migrate Application Layer

**Task ID**: `20250621004`
**Assignee**: `@coding_agent`
**Status**: `in_progress`
**Priority**: `high`

## 1. Objective

Migrate the Application Layer from `cursor_agent/src/task_mcp/application/` to `dhafnck_mcp_main/src/fastmcp/dhafnck_mcp/application/`. This involves copying application services, use cases, and command/query handlers, then updating all import statements to correctly reference the newly migrated domain layer.

## 2. Technical Requirements

### Source Files to Migrate:
```
cursor_agent/src/task_mcp/application/
â”œâ”€â”€ services/
â”œâ”€â”€ use_cases/
â”œâ”€â”€ commands/
â”œâ”€â”€ queries/
â”œâ”€â”€ handlers/
â””â”€â”€ dto/
```

### Target Location:
```
dhafnck_mcp_main/src/fastmcp/dhafnck_mcp/application/
```

### Key Implementation Steps:
1. **Copy Application Files**: Transfer all application layer files maintaining structure
2. **Update Domain References**: Fix imports to use new `fastmcp.task_management.domain` paths
3. **Validate Use Cases**: Ensure all application services and use cases work correctly
4. **Update Application Tests**: Migrate and adapt application-level unit tests
5. **Verify Service Integration**: Ensure proper integration with domain layer

## 3. Migration Specifics

### Import Path Changes:
- **Domain References**: 
  - **From**: `from task_mcp.domain.entities import Task`
  - **To**: `from fastmcp.task_management.domain.entities import Task`
- **Application References**:
  - **From**: `from task_mcp.application.services import TaskService`
  - **To**: `from fastmcp.task_management.application.services import TaskService`

### Application Components to Migrate:
- **Services**: Application business logic orchestration
- **Use Cases**: Specific business operations (CreateTask, UpdateTask, etc.)
- **Commands**: Write operations with validation
- **Queries**: Read operations and data retrieval
- **Handlers**: Command and query processing logic
- **DTOs**: Data Transfer Objects for API boundaries

## 4. Success Criteria

- [ ] All application files copied to new location
- [ ] Domain layer imports updated correctly
- [ ] Application unit tests pass in new environment
- [ ] Use cases execute without errors
- [ ] Service layer integration validated
- [ ] Command/Query handlers functional

## 5. Dependencies

**Requires**: Task 20250621003 (Domain Layer Migration) - ðŸ”„ In Progress
**Blocks**: Task 20250621005 (Infrastructure Layer Migration)
**References**: [`migration_plan.md`](mdc:../../migration_plan.md)
**Part of**: EPIC 20250621001 - Complete task_mcp module migration

## 6. Testing Strategy

### Application Tests to Validate:
- Use case execution flows
- Command validation and processing
- Query result accuracy
- Service layer orchestration
- DTO serialization/deserialization
- Error handling and exceptions

### Integration Points:
- [ ] Domain entity manipulation
- [ ] Repository interface usage
- [ ] Business rule enforcement
- [ ] Cross-cutting concerns (logging, validation)

## 7. Critical Considerations

### Dependency Management:
- Application layer depends heavily on domain layer
- Must ensure domain migration (20250621003) is complete before finalizing application migration
- Validate that all domain interfaces are properly implemented

### Service Architecture:
- Maintain clean architecture principles
- Preserve separation of concerns
- Ensure proper dependency injection patterns

## 8. Notes

The application layer orchestrates domain operations and implements use cases. It's crucial to maintain the integrity of business workflows during migration while ensuring proper integration with the migrated domain layer.
